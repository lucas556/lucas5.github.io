<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=2"><meta name=robots content="noodp"><title>区块链安全:构建主动防御节点阻止钱包欺诈交易 - Lucas's Blog</title><meta name=author content="Lucas"><meta name=description content="通过构建主动防御节点,有效拦截以太坊高风险授权交易,支持合约黑名单与地址白名单,保护用户资产安全."><meta name=keywords content='区块链安全,钱包安全,授权'><meta itemprop=name content="区块链安全:构建主动防御节点阻止钱包欺诈交易"><meta itemprop=description content="通过构建主动防御节点,有效拦截以太坊高风险授权交易,支持合约黑名单与地址白名单,保护用户资产安全."><meta itemprop=datePublished content="2025-08-03T00:00:00+00:00"><meta itemprop=dateModified content="2025-08-03T00:00:00+00:00"><meta itemprop=wordCount content="1629"><meta itemprop=keywords content="区块链安全,钱包安全,授权"><meta property="og:url" content="https://www.lucas6.xyz/posts/building-safety-nodes/"><meta property="og:site_name" content="Lucas's Blog"><meta property="og:title" content="区块链安全:构建主动防御节点阻止钱包欺诈交易"><meta property="og:description" content="通过构建主动防御节点,有效拦截以太坊高风险授权交易,支持合约黑名单与地址白名单,保护用户资产安全."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-08-03T00:00:00+00:00"><meta property="article:modified_time" content="2025-08-03T00:00:00+00:00"><meta property="article:tag" content="区块链安全"><meta property="article:tag" content="钱包安全"><meta property="article:tag" content="授权"><meta name=twitter:card content="summary"><meta name=twitter:title content="区块链安全:构建主动防御节点阻止钱包欺诈交易"><meta name=twitter:description content="通过构建主动防御节点,有效拦截以太坊高风险授权交易,支持合约黑名单与地址白名单,保护用户资产安全."><meta name=application-name content="FixIt"><meta name=apple-mobile-web-app-title content="FixIt"><meta name=theme-color data-light=#f8f8f8 data-dark=#252627 content="#f8f8f8"><meta name=msapplication-TileColor content="#da532c"><link rel=icon href=/images/favicon.svg><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=canonical type=text/html href=https://www.lucas6.xyz/posts/building-safety-nodes/ title="区块链安全:构建主动防御节点阻止钱包欺诈交易 - Lucas's Blog"><link rel=prev type=text/html href=https://www.lucas6.xyz/posts/yubikey-coldwallet-gpgkey-ethaddress/ title="基于 YubiKey 的冷钱包探索 2：使用 GPG 私钥生成以太坊地址"><link rel=next type=text/html href=https://www.lucas6.xyz/posts/eth-tron-address-deep-dive/ title=区块链地址生成实战><link rel=alternate type=text/markdown href=https://www.lucas6.xyz/posts/building-safety-nodes/index.md title="区块链安全:构建主动防御节点阻止钱包欺诈交易 - Lucas's Blog"><link rel=stylesheet href=/css/style.min.css><link rel=preload href=/lib/fontawesome-free/all.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.css></noscript><link rel=preload href=/lib/animate/animate.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/animate/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"区块链安全:构建主动防御节点阻止钱包欺诈交易","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/www.lucas6.xyz\/posts\/building-safety-nodes\/"},"genre":"posts","keywords":"区块链安全, 钱包安全, 授权","wordcount":1629,"url":"https:\/\/www.lucas6.xyz\/posts\/building-safety-nodes\/","datePublished":"2025-08-03T00:00:00+00:00","dateModified":"2025-08-03T00:00:00+00:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Lucas"},"description":"通过构建主动防御节点,有效拦截以太坊高风险授权交易,支持合约黑名单与地址白名单,保护用户资产安全."}</script><script src=/js/head/color-scheme.min.js></script><link rel=preload href=/lib/webfonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/lib/webfonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/override.css media=print onload='this.media="all"'><noscript><link rel=stylesheet href=/css/override.css></noscript></head><body data-header-desktop=sticky data-header-mobile=auto><div class=wrapper data-page-style=normal><header class="desktop animate__faster" id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Lucas's Blog"><span class=header-title-text>Lucas's Blog</span></a><span class=header-subtitle></span></div><nav><ul class=menu><li class=menu-item><a class=menu-link href=/archives/ title=查看历史文章归档><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> Archives</a></li><li class=menu-item><a class=menu-link href=/categories/ title=查看文章分类><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden=true></i> Categories</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> Tags</a></li><li class=menu-item><a class=menu-link href=/about><i class='fas fa-user'></i> about</a></li><li class="menu-item delimiter"></li><li class="menu-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li></ul></nav></div></header><header class="mobile animate__faster" id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Lucas's Blog"><span class=header-title-text>Lucas's Blog</span></a><span class=header-subtitle></span></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><nav><ul class=menu id=menu-mobile><li class=menu-item><a class=menu-link href=/archives/ title=查看历史文章归档><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> Archives</a></li><li class=menu-item><a class=menu-link href=/categories/ title=查看文章分类><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden=true></i> Categories</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> Tags</a></li><li class=menu-item><a class=menu-link href=/about><i class='fas fa-user'></i> about</a></li><li class="menu-item menu-system"><span class="menu-system-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></span></li></ul></nav></div></header><main class=container><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label=合集></aside><article class="page single"><div class=header><h1 class="single-title animate__animated animate__flipInX"><span>区块链安全:构建主动防御节点阻止钱包欺诈交易</span></h1></div><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://www.lucas6.xyz title=作者 target=_blank rel="external nofollow noopener noreferrer author" class=author><img class=avatar src=/images/favicon.svg alt=Lucas height=16 width=16>&nbsp;Lucas</a></span></div><div class=post-meta-line><span title="发布于 2025-08-03 00:00:00"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden=true></i><time datetime=2025-08-03>2025-08-03</time></span>&nbsp;<span title="1629 字"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden=true></i>约 1700 字</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden=true></i>预计阅读 4 分钟</span>&nbsp;</div></div><div class="details toc" id=toc-static data-kept=false><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fa-solid fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#常见的欺诈类型及典型案例>常见的欺诈类型及典型案例</a></li><li><a href=#如何有效预防>如何有效预防</a></li><li><a href=#技术实现原理与操作细节>技术实现原理与操作细节</a></li><li><a href=#cloudflare-worker详细代码实现>Cloudflare Worker详细代码实现</a></li><li><a href=#具体部署操作步骤>具体部署操作步骤</a></li><li><a href=#钱包配置实例参考>钱包配置实例参考</a></li><li><a href=#实际使用注意事项>实际使用注意事项</a></li><li><a href=#总结与扩展建议>总结与扩展建议</a></li></ul></nav></div></div><div class=content id=content><p>随着区块链应用的普及,欺诈行为日益频繁.据 Chainalysis 报告,2024年加密资产犯罪活动导致损失超过40亿美元,其中因授权类诈骗损失达20%.这类欺诈通常涉及诱导用户签署恶意授权交易,而对于普通用户而言,这类授权功能往往是非必要的.</p><h2 class=heading-element id=常见的欺诈类型及典型案例><span>常见的欺诈类型及典型案例</span>
<a href=#%e5%b8%b8%e8%a7%81%e7%9a%84%e6%ac%ba%e8%af%88%e7%b1%bb%e5%9e%8b%e5%8f%8a%e5%85%b8%e5%9e%8b%e6%a1%88%e4%be%8b class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><ol><li><strong>钓鱼网站诈骗</strong>：攻击者伪装成知名项目或钱包的官网,引诱用户进行无限授权.如著名的MetaMask假网站案件,数百万美元资产因此被盗.</li><li><strong>空投诈骗</strong>：虚假的免费代币或NFT空投,引导用户签署无限授权合约,如近期的Blur假空投诈骗导致大量用户资产被窃取.</li><li><strong>虚假挖矿投资</strong>：承诺高额收益,实际骗取用户授权后转移资产,如 &ldquo;Luna Mining&rdquo; 诈骗事件.</li><li><strong>DEX授权诈骗</strong>：攻击者在去中心化交易所内误导用户进行无限授权,如 PancakeSwap 假合约事件.</li></ol><p>由于普通用户日常使用钱包并不经常涉及需要授权的场景,因此通过设置主动防御节点,能够有效降低此类风险.这种节点会在用户签署交易之后;真正广播到区块链网络之前,自动检查交易内容并过滤掉可能存在危险的授权交易.这种机制不仅适用于以太坊,也适用于其他基于EVM的区块链网络(例如币安智能链 BSC; Polygon; Tron等).</p><h2 class=heading-element id=如何有效预防><span>如何有效预防</span>
<a href=#%e5%a6%82%e4%bd%95%e6%9c%89%e6%95%88%e9%a2%84%e9%98%b2 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><ul><li>谨慎访问未知链接,避免轻易授权.</li><li>签署钱包交易前仔细核对合约地址与交易详情.</li><li>使用主动防御节点或自定义安全节点对所有交易进行自动检查.</li><li>定期审查钱包授权状态,撤销不必要的授权.</li></ul><h2 class=heading-element id=技术实现原理与操作细节><span>技术实现原理与操作细节</span>
<a href=#%e6%8a%80%e6%9c%af%e5%ae%9e%e7%8e%b0%e5%8e%9f%e7%90%86%e4%b8%8e%e6%93%8d%e4%bd%9c%e7%bb%86%e8%8a%82 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>为了防范上述欺诈风险,本文采用 <strong>Cloudflare Worker</strong> 与 <strong>Infura</strong> 搭建主动防御节点，对高风险授权交易进行拦截。该节点作为交易检查中继，工作流程如下：</p><ol><li>用户在钱包中签署交易后,交易首先发送至 Cloudflare Worker 进行安全检查</li><li>只有通过检查的交易,才会被转发至以太坊主网节点(例如 Infura)进行广播</li></ol><p>此外,由于 Cloudflare Worker 部署在边缘网络,还能有效隐藏用户真实 IP,从而增强隐私保护.</p><p>具体拦截规则包括:</p><ul><li>拦截高风险授权函数签名（例如<code>approve</code>;<code>increaseAllowance</code>;<code>setApprovalForAll</code>）.</li><li>阻止与黑名单合约地址进行任何交互.</li><li>设置资产转移白名单,只允许向信任地址进行转账.</li></ul><h2 class=heading-element id=cloudflare-worker详细代码实现><span>Cloudflare Worker详细代码实现</span>
<a href=#cloudflare-worker%e8%af%a6%e7%bb%86%e4%bb%a3%e7%a0%81%e5%ae%9e%e7%8e%b0 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=c1>// 此代码未经测试;实际部署中需要测试
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kr>const</span> <span class=nx>BLOCKED_SELECTORS</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;0x095ea7b3&#39;</span><span class=p>,</span> <span class=c1>// approve
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=s1>&#39;0x39509351&#39;</span><span class=p>,</span> <span class=c1>// increaseAllowance
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=s1>&#39;0xa22cb465&#39;</span>  <span class=c1>// setApprovalForAll
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>BLACKLIST_CONTRACTS</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Set</span><span class=p>([</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;0xdeaddeaddeaddeaddeaddeaddeaddeaddeadbeef&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;0x1234567890abcdef1234567890abcdef12345678&#39;</span>
</span></span><span class=line><span class=cl><span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>ENABLE_WHITELIST</span> <span class=o>=</span> <span class=kc>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kr>const</span> <span class=nx>WHITELIST_RECIPIENTS</span> <span class=o>=</span> <span class=k>new</span> <span class=nx>Set</span><span class=p>([</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;0xaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=s1>&#39;0xbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb&#39;</span>
</span></span><span class=line><span class=cl><span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>export</span> <span class=k>default</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kr>async</span> <span class=nx>fetch</span><span class=p>(</span><span class=nx>request</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>request</span><span class=p>.</span><span class=nx>method</span> <span class=o>!==</span> <span class=s1>&#39;POST&#39;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=k>new</span> <span class=nx>Response</span><span class=p>(</span><span class=s1>&#39;Only POST allowed&#39;</span><span class=p>,</span> <span class=p>{</span> <span class=nx>status</span><span class=o>:</span> <span class=mi>405</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>body</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>request</span><span class=p>.</span><span class=nx>json</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>tx</span> <span class=o>=</span> <span class=nx>body</span><span class=o>?</span><span class=p>.</span><span class=nx>params</span><span class=o>?</span><span class=p>.[</span><span class=mi>0</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>to</span> <span class=o>=</span> <span class=nx>tx</span><span class=o>?</span><span class=p>.</span><span class=nx>to</span><span class=o>?</span><span class=p>.</span><span class=nx>toLowerCase</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>data</span> <span class=o>=</span> <span class=nx>tx</span><span class=o>?</span><span class=p>.</span><span class=nx>data</span><span class=o>?</span><span class=p>.</span><span class=nx>toLowerCase</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>data</span> <span class=o>&amp;&amp;</span> <span class=nx>BLOCKED_SELECTORS</span><span class=p>.</span><span class=nx>some</span><span class=p>(</span><span class=nx>sig</span> <span class=p>=&gt;</span> <span class=nx>data</span><span class=p>.</span><span class=nx>startsWith</span><span class=p>(</span><span class=nx>sig</span><span class=p>)))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=k>new</span> <span class=nx>Response</span><span class=p>(</span><span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>({</span> <span class=nx>error</span><span class=o>:</span> <span class=s1>&#39;已拦截危险授权交易&#39;</span> <span class=p>}),</span> <span class=p>{</span> <span class=nx>status</span><span class=o>:</span> <span class=mi>403</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>to</span> <span class=o>&amp;&amp;</span> <span class=nx>BLACKLIST_CONTRACTS</span><span class=p>.</span><span class=nx>has</span><span class=p>(</span><span class=nx>to</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=k>new</span> <span class=nx>Response</span><span class=p>(</span><span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>({</span> <span class=nx>error</span><span class=o>:</span> <span class=s1>&#39;目标地址属于黑名单合约&#39;</span> <span class=p>}),</span> <span class=p>{</span> <span class=nx>status</span><span class=o>:</span> <span class=mi>403</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>ENABLE_WHITELIST</span> <span class=o>&amp;&amp;</span> <span class=nx>to</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=nx>WHITELIST_RECIPIENTS</span><span class=p>.</span><span class=nx>has</span><span class=p>(</span><span class=nx>to</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=k>new</span> <span class=nx>Response</span><span class=p>(</span><span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>({</span> <span class=nx>error</span><span class=o>:</span> <span class=s1>&#39;非白名单地址禁止转账&#39;</span> <span class=p>}),</span> <span class=p>{</span> <span class=nx>status</span><span class=o>:</span> <span class=mi>403</span> <span class=p>});</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>response</span> <span class=o>=</span> <span class=kr>await</span> <span class=nx>fetch</span><span class=p>(</span><span class=s1>&#39;https://mainnet.infura.io/v3/YOUR_INFURA_PROJECT_ID&#39;</span><span class=p>,</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>method</span><span class=o>:</span> <span class=s1>&#39;POST&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>headers</span><span class=o>:</span> <span class=p>{</span> <span class=s1>&#39;Content-Type&#39;</span><span class=o>:</span> <span class=s1>&#39;application/json&#39;</span> <span class=p>},</span>
</span></span><span class=line><span class=cl>      <span class=nx>body</span><span class=o>:</span> <span class=nx>JSON</span><span class=p>.</span><span class=nx>stringify</span><span class=p>(</span><span class=nx>body</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>});</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>response</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>};</span></span></span></code></pre></td></tr></table></div></div><h2 class=heading-element id=具体部署操作步骤><span>具体部署操作步骤</span>
<a href=#%e5%85%b7%e4%bd%93%e9%83%a8%e7%bd%b2%e6%93%8d%e4%bd%9c%e6%ad%a5%e9%aa%a4 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><ol><li>登录<a href=https://workers.cloudflare.com/ target=_blank rel="external nofollow noopener noreferrer">Cloudflare Workers</a>后台.</li><li>创建新的Worker,复制上述代码到编辑器中.</li><li>替换代码中的<code>YOUR_INFURA_PROJECT_ID</code>为你个人的Infura项目ID.</li><li>点击"保存并部署",获得Worker节点URL,如 <code>https://your-worker.workers.dev</code>.</li></ol><h2 class=heading-element id=钱包配置实例参考><span>钱包配置实例参考</span>
<a href=#%e9%92%b1%e5%8c%85%e9%85%8d%e7%bd%ae%e5%ae%9e%e4%be%8b%e5%8f%82%e8%80%83 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><ul><li>进入钱包设置 &ndash;> 网络 &ndash;> 添加新网络.</li><li>网络名称填入"主动防御节点".</li><li>RPC URL 填入上述 Worker URL.</li><li>Chain ID填写为1,符号ETH.(有些钱包只需要填写prc地址)</li></ul><p>设置后,钱包发出的交易都会先经过此节点检查再上链.</p><h2 class=heading-element id=实际使用注意事项><span>实际使用注意事项</span>
<a href=#%e5%ae%9e%e9%99%85%e4%bd%bf%e7%94%a8%e6%b3%a8%e6%84%8f%e4%ba%8b%e9%a1%b9 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>如果你经常使用去中心化交易所(DEX),直接使用此节点可能导致交易失败,这是因为DEX需要授权函数调用.</p><p>建议方案包括：</p><ul><li>将安全且频繁使用的DEX授权合约加入白名单.</li><li>对于需要频繁授权的交易,使用单独的钱包,以减少资产风险.</li></ul><h2 class=heading-element id=总结与扩展建议><span>总结与扩展建议</span>
<a href=#%e6%80%bb%e7%bb%93%e4%b8%8e%e6%89%a9%e5%b1%95%e5%bb%ba%e8%ae%ae class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>通过主动防御节点,我们能有效防范区块链授权类诈骗,保护资产安全.本方案除了以太坊外,同样适用于币安智能链(BSC);Polygon等EVM兼容链,实际使用时只需更换相应RPC地址.</p><p>未来还可考虑集成诈骗地址实时数据库;报警通知系统（如Telegram或钉钉）,进一步提升安全性.</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span title="更新于 2025-08-03 00:00:00">更新于 2025-08-03&nbsp;</span></div><div class=post-info-license><span><a rel="license external nofollow noopener noreferrer" href=https://creativecommons.org/licenses/by-nc-sa/4.0/ target=_blank>CC BY-NC-SA 4.0</a></span></div></div><div class=post-info-line><div class=post-info-md><span><a href=/posts/building-safety-nodes/index.md title=阅读原始文档 class=link-to-markdown>阅读原始文档</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="分享到 X" data-sharer=twitter data-url=https://www.lucas6.xyz/posts/building-safety-nodes/ data-title=区块链安全:构建主动防御节点阻止钱包欺诈交易 data-hashtags=区块链安全,钱包安全,授权><i class="fa-brands fa-x-twitter fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 Facebook" data-sharer=facebook data-url=https://www.lucas6.xyz/posts/building-safety-nodes/ data-hashtag=区块链安全><i class="fa-brands fa-facebook-square fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 微博" data-sharer=weibo data-url=https://www.lucas6.xyz/posts/building-safety-nodes/ data-title=区块链安全:构建主动防御节点阻止钱包欺诈交易><i class="fa-brands fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fa-solid fa-tags fa-fw me-1" aria-hidden=true></i><a href=/tags/%E5%8C%BA%E5%9D%97%E9%93%BE%E5%AE%89%E5%85%A8/ class=post-tag title="标签 - 区块链安全">区块链安全</a><a href=/tags/%E9%92%B1%E5%8C%85%E5%AE%89%E5%85%A8/ class=post-tag title="标签 - 钱包安全">钱包安全</a><a href=/tags/%E6%8E%88%E6%9D%83/ class=post-tag title="标签 - 授权">授权</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/posts/yubikey-coldwallet-gpgkey-ethaddress/ class=post-nav-item rel=prev title="基于 YubiKey 的冷钱包探索 2：使用 GPG 私钥生成以太坊地址"><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i>基于 YubiKey 的冷钱包探索 2：使用 GPG 私钥生成以太坊地址</a><a href=/posts/eth-tron-address-deep-dive/ class=post-nav-item rel=next title=区块链地址生成实战>区块链地址生成实战<i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article><aside class=toc id=toc-auto aria-label=目录><h2 class=toc-title>目录&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden=true></i></h2><div class=toc-content id=toc-content-auto></div></aside></main><footer class=footer><div class=footer-container><script>window.addEventListener("load",function(){var e=document.createElement("script");e.src="https://www.lucas6.xyz/plugins/js-sdk-pro.min.js",e.async=!0,e.onload=function(){LA.init({id:"3NHsYi6Mg6jwyr74",ck:"3NHsYi6Mg6jwyr74"})},document.head.appendChild(e)})</script><div class="footer-line powered">由 <a href=https://gohugo.io/ target=_blank rel="external nofollow noopener noreferrer" title="Hugo 0.147.7">Hugo</a> 强力驱动 | 主题 - <a href=https://github.com/hugo-fixit/FixIt target=_blank rel=external title="FixIt v0.4.0-alpha-20250721024521-a1cd700b">FixIt</a></div><div class="footer-line copyright" itemscope itemtype=http://schema.org/CreativeWork><i class="fa-regular fa-copyright fa-fw" aria-hidden=true></i>
<span itemprop=copyrightYear>2023 - 2025</span><span class=author itemprop=copyrightHolder>
<a href=https://www.lucas6.xyz target=_blank rel="external nofollow noopener noreferrer">Lucas</a></span><span class="license footer-divider"><a href=https://www.lucas6.xyz/copyright/ target=_blank>版权声明 / Copyright</a> | <a rel="license external nofollow noopener noreferrer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div><div class="footer-line beian"><span class=gov><a href="https://beian.mps.gov.cn/#/query/webSearch?code=41100002000596" target=_blank rel="nofollow noopener noreferrer"><span>豫公网安备 41100002000596号</span></a></span><span class="icp footer-divider"><a href=https://beian.miit.gov.cn/ target=_blank rel="nofollow noopener noreferrer">豫ICP备2025141250号-1</a></span></div></div></footer></div><div class=widgets><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role=button aria-label=回到顶部><i class="fa-solid fa-arrow-up fa-fw" aria-hidden=true></i><span class="variant-numeric d-none">0%</span></div></div><div id=mask></div><noscript><div class=noscript-warning>该网站在启用 JavaScript 的情况下效果最佳。</div></noscript></div><link rel=stylesheet href=/lib/cookieconsent/cookieconsent.min.css><script src=/lib/sharer/sharer.min.js async defer></script><script src=/lib/cookieconsent/cookieconsent.min.js defer></script><script>window.config={code:{copyTitle:"复制到剪贴板",editLockTitle:"锁定可编辑代码块",editUnLockTitle:"解锁可编辑代码块",editable:!0,maxShownLines:10},comment:{enable:!1},cookieconsent:{content:{dismiss:"同意",link:"了解更多",message:"本网站使用 Cookies 来改善您的浏览体验。"},enable:!0,palette:{button:{background:"#f0f0f0"},popup:{background:"#1aa3ff"}},theme:"edgeless"},version:"v0.4.0-alpha-20250721024521-a1cd700b"}</script><script src=/js/theme.min.js defer></script></body></html>