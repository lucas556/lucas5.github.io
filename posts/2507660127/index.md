# æœ¬åœ°æž„é€ TronTransactionè½¬è´¦äº¤æ˜“


åœ¨å®žé™…å¼€å‘ä¸­,æŸäº›åœºæ™¯è¦æ±‚æˆ‘ä»¬å¯¹äº¤æ˜“è¿‡ç¨‹å…·å¤‡æ›´é«˜çš„å¯æŽ§æ€§ä¸Žå®‰å…¨æ€§.æ¯”å¦‚åœ¨ç¡¬ä»¶é’±åŒ…ä¸­ä½¿ç”¨ç§é’¥ç­¾å,æˆ–åœ¨å†·éš”ç¦»çŽ¯å¢ƒä¸‹è¿›è¡Œç¦»çº¿äº¤æ˜“æž„é€ æ—¶,å¿…é¡»é¿å…ä¾èµ– TRON èŠ‚ç‚¹çš„ `createtransaction` æŽ¥å£.è¿™å°±éœ€è¦æˆ‘ä»¬**åœ¨æœ¬åœ°æž„é€ äº¤æ˜“ç»“æž„ã€æ‰‹åŠ¨å¡«å…¥åŒºå—æ•°æ®å¹¶å®Œæˆç­¾å**,å†å¹¿æ’­è‡³ä¸»ç½‘.

æœ¬æ–‡å®Œæ•´çš„ Python ä»£ç å·²æ‰˜ç®¡ï¼š

ðŸ“Ž [https://github.com/lucas556/Blockchain-Tools/blob/main/TRON/Offline_transactions.py](https://github.com/lucas556/Blockchain-Tools/blob/main/TRON/Offline_transactions.py)

---

## å®˜æ–¹æŽ¥å£ä¸Žæœ¬åœ°æž„é€ çš„åŒºåˆ«

| å¯¹æ¯”é¡¹            | å®˜æ–¹ createtransaction æŽ¥å£            | æœ¬åœ°æž„é€ æµç¨‹                         |
|-------------------|------------------------------------------|--------------------------------------|
| æž„é€ è¡Œä¸º          | èŠ‚ç‚¹æœåŠ¡ç«¯ç”Ÿæˆäº¤æ˜“ç»“æž„                 | å®¢æˆ·ç«¯å…¨æµç¨‹æ‰‹åŠ¨æž„é€                  |
| å®‰å…¨æŽ§åˆ¶          | äº¤æ˜“å†…å®¹ä¸Žç»“æž„æš´éœ²äºŽè¿œç¨‹èŠ‚ç‚¹           | æ•´ä¸ªè¿‡ç¨‹åœ¨æœ¬åœ°å®Œæˆ,é¿å…éšç§æ³„éœ²     |
| çµæ´»æ€§            | å›ºå®šå­—æ®µç»“æž„,è¾ƒéš¾æ‰©å±•                 | è‡ªå®šä¹‰åŒºå—å¼•ç”¨ã€æ—¶é—´ã€ç­¾åç­‰ç»†èŠ‚     |
| é€‚ç”¨åœºæ™¯          | é€‚åˆçƒ­é’±åŒ…ã€é«˜é€Ÿäº¤äº’                   | é€‚åˆå†·é’±åŒ…ã€éš”ç¦»ç­¾åã€å¤šç­¾ã€å®¡è®¡åˆ†æž |

---

## æž„é€ æµç¨‹æ¦‚è§ˆ

è¿™é‡Œä½¿ç”¨ Python ä»£ç å®Œæˆä»¥ä¸‹æ­¥éª¤ï¼š

1. è°ƒç”¨ `getblock` æŽ¥å£èŽ·å–æœ€æ–°å—å¼•ç”¨
2. æž„é€  TransferContract ç±»åž‹çš„äº¤æ˜“ç»“æž„
3. å¡«å……åŒºå—å­—æ®µã€åœ°å€ã€é‡‘é¢ã€è¿‡æœŸæ—¶é—´ã€æ—¶é—´æˆ³
4. ä½¿ç”¨ secp256k1 ç§é’¥è¿›è¡Œç­¾å
5. ç”Ÿæˆ txID
6. å¹¿æ’­äº¤æ˜“åˆ°ä¸»ç½‘

---

## æ³¨æ„

### åœ°å€æ ¼å¼è½¬æ¢

Tron åœ°å€éœ€é€šè¿‡ base58 è§£ç ä¸º hex å­—ç¬¦ä¸²,ä¸”å¿…é¡»ä»¥ `41` å¼€å¤´ï¼ˆä»£è¡¨ä¸»ç½‘åœ°å€ï¼‰.è‹¥æœªä¸¥æ ¼ä½¿ç”¨ `base58.b58decode_check` å‡½æ•°,ä¼šå¯¼è‡´ç­¾åæ— æ•ˆæˆ–èŠ‚ç‚¹æ‹’ç»äº¤æ˜“.

```python
decoded = base58.b58decode_check(base58_address)
if not decoded.hex().startswith("41"):
    raise ValueError("Invalid Tron address")
```

---

### åŒºå—å¼•ç”¨å­—æ®µè¦æ±‚

æ¯ç¬”äº¤æ˜“å¿…é¡»æºå¸¦ï¼š

- `ref_block_bytes`: å½“å‰åŒºå—é«˜åº¦å¯¹ 65536 çš„æ¨¡
- `ref_block_hash`: åŒºå— ID å‰ 8 å­—èŠ‚ï¼ˆ16 hex å­—ç¬¦ï¼‰

è¿™ä¸¤è€…å¿…é¡»ä¸Žæœ€æ–°å—åŒ¹é…,å¦åˆ™å°†è¿”å›ž `INVALID_BLOCK_REFERENCE`.

---

### ç­¾åæ–¹å¼

ä½¿ç”¨æ ‡å‡† secp256k1 æ›²çº¿è¿›è¡Œ ECDSA ç­¾åï¼ˆSHA-256 æ‘˜è¦ï¼‰,ä»£ç ä¸­ä½¿ç”¨ `cryptography.hazmat` åº“å®Œæˆ.æ³¨æ„,ç­¾åå¿…é¡»è½¬ hex,å¹¶ä»¥æ•°ç»„å½¢å¼å­˜æ”¾ï¼š

```json
"signature": ["hex_encoded_signature"]
```

---

### å­—èŠ‚ç»“æž„éœ€éµå¾ªåè®®

åŽŸå§‹äº¤æ˜“æ•°æ®éœ€ä¸¥æ ¼æŒ‰ TRON protobuf ç¼–ç è§„åˆ™æ‰‹åŠ¨æž„é€ ,åŒ…æ‹¬ tag ç¼–å·ã€é¡ºåºã€å­—æ®µç±»åž‹.è¯¥ä»£ç å®žçŽ°é€‚ç”¨äºŽæ ‡å‡†çš„ TransferContract,å…¶ä»–åˆçº¦ç±»åž‹éœ€è°ƒæ•´å­—æ®µé¡ºåºä¸Žç±»åž‹æ ‡è®°.

---

## åº”ç”¨åœºæ™¯ä¸¾ä¾‹

- **ç¡¬ä»¶é’±åŒ…äº¤äº’**ï¼šä»…æŽ¥å—äº¤æ˜“ç»“æž„,ä¸ä¾èµ– createtransaction æŽ¥å£,å¯é…åˆ Ledgerã€Trezor ç­‰ä½¿ç”¨
- **å†·é’±åŒ…ç¦»çº¿ç­¾å**ï¼šåœ¨ air-gapped çŽ¯å¢ƒä¸‹æž„é€  raw_data å¹¶ç­¾ååŽå¯¼å‡º
- **åˆè§„å®¡è®¡åˆ†æžå·¥å…·**ï¼šå¯ä»¥è¿˜åŽŸäº¤æ˜“ç»“æž„ä¸Ž txID,è¾…åŠ©ç›‘ç®¡ä¸Žé“¾ä¸Šå–è¯
- **å¤šç­¾é’±åŒ…æˆ–èšåˆäº¤æ˜“ç³»ç»Ÿ**ï¼šå¯çµæ´»æŽ§åˆ¶å¤šç¬”äº¤æ˜“æ‰¹é‡æž„é€ ä¸Žç­¾åè¡Œä¸º

---



---

> ä½œè€…: [Lucas](https://lucas5.xyz)  
> URL: https://lucas5.xyz/posts/2507660127/  

