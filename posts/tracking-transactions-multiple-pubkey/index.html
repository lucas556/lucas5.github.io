<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=2"><meta name=robots content="noodp"><title>基于区块链交易公钥在多链进行跨链追查: 原理与实践 - Lucas's Blog</title><meta name=author content="Lucas"><meta name=description content="随着区块链技术的不断发展,越来越多的项目和资金分散在不同的区块链网络中.对于合规审计、安全追踪和资金流动分析等场景,如何确定同一个私钥是否在多条链上产生实际交易,往往是突破口之一.本文将介绍一个普适的技术思路：通过在某条链(如以太坊)获取交易公钥,再将其转换到另一条采用相同椭圆曲线(secp256k1)的链(如比特币),进而在该链上验证是否有对应的签名交易,从而确认是否确系同一私钥所控.
"><meta name=keywords content='public-key,cross-chain,ecrecover,bitcoin,ethereum'><meta itemprop=name content="基于区块链交易公钥在多链进行跨链追查: 原理与实践"><meta itemprop=description content="随着区块链技术的不断发展,越来越多的项目和资金分散在不同的区块链网络中.对于合规审计、安全追踪和资金流动分析等场景,如何确定同一个私钥是否在多条链上产生实际交易,往往是突破口之一.本文将介绍一个普适的技术思路：通过在某条链(如以太坊)获取交易公钥,再将其转换到另一条采用相同椭圆曲线(secp256k1)的链(如比特币),进而在该链上验证是否有对应的签名交易,从而确认是否确系同一私钥所控."><meta itemprop=datePublished content="2025-02-28T01:00:00+08:00"><meta itemprop=dateModified content="2025-02-28T01:00:00+08:00"><meta itemprop=wordCount content="2315"><meta itemprop=keywords content="Public-Key,Cross-Chain,Ecrecover,Bitcoin,Ethereum"><meta property="og:url" content="https://www.lucas6.xyz/posts/tracking-transactions-multiple-pubkey/"><meta property="og:site_name" content="Lucas's Blog"><meta property="og:title" content="基于区块链交易公钥在多链进行跨链追查: 原理与实践"><meta property="og:description" content="随着区块链技术的不断发展,越来越多的项目和资金分散在不同的区块链网络中.对于合规审计、安全追踪和资金流动分析等场景,如何确定同一个私钥是否在多条链上产生实际交易,往往是突破口之一.本文将介绍一个普适的技术思路：通过在某条链(如以太坊)获取交易公钥,再将其转换到另一条采用相同椭圆曲线(secp256k1)的链(如比特币),进而在该链上验证是否有对应的签名交易,从而确认是否确系同一私钥所控."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-02-28T01:00:00+08:00"><meta property="article:modified_time" content="2025-02-28T01:00:00+08:00"><meta property="article:tag" content="Public-Key"><meta property="article:tag" content="Cross-Chain"><meta property="article:tag" content="Ecrecover"><meta property="article:tag" content="Bitcoin"><meta property="article:tag" content="Ethereum"><meta name=twitter:card content="summary"><meta name=twitter:title content="基于区块链交易公钥在多链进行跨链追查: 原理与实践"><meta name=twitter:description content="随着区块链技术的不断发展,越来越多的项目和资金分散在不同的区块链网络中.对于合规审计、安全追踪和资金流动分析等场景,如何确定同一个私钥是否在多条链上产生实际交易,往往是突破口之一.本文将介绍一个普适的技术思路：通过在某条链(如以太坊)获取交易公钥,再将其转换到另一条采用相同椭圆曲线(secp256k1)的链(如比特币),进而在该链上验证是否有对应的签名交易,从而确认是否确系同一私钥所控."><meta name=application-name content="FixIt"><meta name=apple-mobile-web-app-title content="FixIt"><meta name=theme-color data-light=#f8f8f8 data-dark=#252627 content="#f8f8f8"><meta name=msapplication-TileColor content="#da532c"><link rel=icon href=/images/favicon.svg><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=canonical type=text/html href=https://www.lucas6.xyz/posts/tracking-transactions-multiple-pubkey/ title="基于区块链交易公钥在多链进行跨链追查: 原理与实践 - Lucas's Blog"><link rel=prev type=text/html href=https://www.lucas6.xyz/posts/gen-privkey/ title="Generating Blockchain Private Key"><link rel=next type=text/html href=https://www.lucas6.xyz/posts/sig-recovery-pubkey/ title=从签名中恢复账户公钥><link rel=alternate type=text/markdown href=https://www.lucas6.xyz/posts/tracking-transactions-multiple-pubkey/index.md title="基于区块链交易公钥在多链进行跨链追查: 原理与实践 - Lucas's Blog"><link rel=stylesheet href=/css/style.min.css><link rel=preload href=/lib/fontawesome-free/all.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.css></noscript><link rel=preload href=/lib/animate/animate.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/animate/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"基于区块链交易公钥在多链进行跨链追查: 原理与实践","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/www.lucas6.xyz\/posts\/tracking-transactions-multiple-pubkey\/"},"genre":"posts","keywords":"public-key, cross-chain, ecrecover, bitcoin, ethereum","wordcount":2315,"url":"https:\/\/www.lucas6.xyz\/posts\/tracking-transactions-multiple-pubkey\/","datePublished":"2025-02-28T01:00:00+08:00","dateModified":"2025-02-28T01:00:00+08:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Lucas"},"description":""}</script><script src=/js/head/color-scheme.min.js></script><script id=LA_COLLECT src=https://www.lucas6.xyz/plugins/js-sdk-pro.min.js defer></script><script defer>LA.init({id:"3NHsYi6Mg6jwyr74",ck:"3NHsYi6Mg6jwyr74"})</script></head><body data-header-desktop=sticky data-header-mobile=auto><div class=wrapper data-page-style=normal><header class="desktop animate__faster" id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Lucas's Blog"><span class=header-title-text>Lucas's Blog</span></a><span class=header-subtitle></span></div><nav><ul class=menu><li class=menu-item><a class=menu-link href=/archives/ title=查看历史文章归档><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> Archives</a></li><li class=menu-item><a class=menu-link href=/categories/ title=查看文章分类><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden=true></i> Categories</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> Tags</a></li><li class=menu-item><a class=menu-link href=/about><i class='fas fa-user'></i> about</a></li><li class="menu-item delimiter"></li><li class="menu-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li></ul></nav></div></header><header class="mobile animate__faster" id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Lucas's Blog"><span class=header-title-text>Lucas's Blog</span></a><span class=header-subtitle></span></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><nav><ul class=menu id=menu-mobile><li class=menu-item><a class=menu-link href=/archives/ title=查看历史文章归档><i class="fa-solid fa-archive fa-fw fa-sm" aria-hidden=true></i> Archives</a></li><li class=menu-item><a class=menu-link href=/categories/ title=查看文章分类><i class="fa-solid fa-folder-tree fa-fw fa-sm" aria-hidden=true></i> Categories</a></li><li class=menu-item><a class=menu-link href=/tags/><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> Tags</a></li><li class=menu-item><a class=menu-link href=/about><i class='fas fa-user'></i> about</a></li><li class="menu-item menu-system"><span class="menu-system-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></span></li></ul></nav></div></header><main class=container><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label=合集></aside><article class="page single"><div class=header><h1 class="single-title animate__animated animate__flipInX"><span>基于区块链交易公钥在多链进行跨链追查: 原理与实践</span></h1></div><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://www.lucas6.xyz title=作者 target=_blank rel="external nofollow noopener noreferrer author" class=author><img class=avatar src=/images/favicon.svg alt=Lucas height=16 width=16>&nbsp;Lucas</a></span><span class=post-included-in>&nbsp;收录于 <a href=/categories/blockchain/ class=post-category title="分类 - Blockchain"><i class="fa-regular fa-folder fa-fw" aria-hidden=true></i> Blockchain</a>&ensp;<a href=/categories/multi-chain/ class=post-category title="分类 - Multi-Chain"><i class="fa-regular fa-folder fa-fw" aria-hidden=true></i> Multi-Chain</a>&ensp;<a href=/categories/security/ class=post-category title="分类 - Security"><i class="fa-regular fa-folder fa-fw" aria-hidden=true></i> Security</a></span></div><div class=post-meta-line><span title="发布于 2025-02-28 01:00:00"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden=true></i><time datetime=2025-02-28>2025-02-28</time></span>&nbsp;<span title="2315 字"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden=true></i>约 2400 字</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden=true></i>预计阅读 5 分钟</span>&nbsp;</div></div><div class="details toc" id=toc-static data-kept=false><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fa-solid fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#1-从以太坊交易中获取公钥>1. 从以太坊交易中获取公钥</a><ul><li><a href=#11-为什么能获取公钥>1.1 为什么能获取公钥？</a></li><li><a href=#12-技术流程>1.2 技术流程</a></li></ul></li><li><a href=#2-转换为比特币地址并在链上追查>2. 转换为比特币地址并在链上追查</a><ul><li><a href=#21-比特币地址生成规则>2.1 比特币地址生成规则</a></li><li><a href=#22-在比特币链上验证实际交易>2.2 在比特币链上验证实际交易</a></li></ul></li><li><a href=#3-多链追查的意义>3. 多链追查的意义</a></li><li><a href=#4-注意事项>4. 注意事项</a></li><li><a href=#5-总结>5. 总结</a></li></ul></nav></div></div><div class=content id=content><p>随着区块链技术的不断发展,越来越多的项目和资金分散在不同的区块链网络中.对于合规审计、安全追踪和资金流动分析等场景,如何确定同一个私钥是否在多条链上产生实际交易,往往是突破口之一.本文将介绍一个<strong>普适的技术思路</strong>：通过在某条链(如以太坊)获取交易公钥,再将其转换到另一条采用相同椭圆曲线(secp256k1)的链(如比特币),进而在该链上验证是否有对应的签名交易,从而确认是否确系同一私钥所控.</p><hr><h2 class=heading-element id=1-从以太坊交易中获取公钥><span>1. 从以太坊交易中获取公钥</span>
<a href=#1-%e4%bb%8e%e4%bb%a5%e5%a4%aa%e5%9d%8a%e4%ba%a4%e6%98%93%e4%b8%ad%e8%8e%b7%e5%8f%96%e5%85%ac%e9%92%a5 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=11-为什么能获取公钥><span>1.1 为什么能获取公钥？</span>
<a href=#11-%e4%b8%ba%e4%bb%80%e4%b9%88%e8%83%bd%e8%8e%b7%e5%8f%96%e5%85%ac%e9%92%a5 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>在以太坊中,每一笔交易都会包含签名字段 <code>(v, r, s)</code>,以及待签名消息的哈希（通常是交易哈希或更底层的 RLP 编码哈希）.以太坊提供了名为 <code>ecrecover</code> 的机制,能从 <code>(v, r, s)</code> 与消息哈希中<strong>恢复</strong>出用于签名的完整公钥.</p><ul><li><strong>签名字段</strong><ul><li><code>v</code>：恢复标记（包含链 ID 信息或椭圆曲线恢复信息）</li><li><code>r</code>、<code>s</code>：签名的核心数据,分别对应椭圆曲线的 x 坐标部分</li></ul></li><li><strong>公钥恢复</strong><ul><li><code>ecrecover(msgHash, v, r, s)</code> → <strong>非压缩公钥</strong>（65 字节,前缀 <code>0x04</code> + X/Y 坐标）</li></ul></li></ul><h3 class=heading-element id=12-技术流程><span>1.2 技术流程</span>
<a href=#12-%e6%8a%80%e6%9c%af%e6%b5%81%e7%a8%8b class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><ol><li><p><strong>提取交易信息</strong><br>在区块浏览器（如 Etherscan）或通过节点 RPC 接口,找到目标地址发起的一笔交易,记录其中的：</p><ul><li><code>v, r, s</code></li><li>交易哈希（或待签名数据哈希）</li></ul></li><li><p><strong>调用 ecrecover</strong><br>可以在本地脚本（如 web3.py、ethers.js 等）中使用内置函数 <code>ecrecover</code>(或等效实现)来恢复公钥.</p></li><li><p><strong>验证正确性</strong><br>以太坊地址 = <code>Keccak-256(公钥去掉前缀 0x04 后 64 字节)</code> 的<strong>后 20 字节</strong>.<br>将恢复得到的地址与交易发起地址比对,如果一致则说明公钥获取无误.</p></li></ol><p>完成上述步骤后,我们便得到了该以太坊地址对应的<strong>真实公钥</strong>（记为 <code>PubKey_ETH</code>）.由于以太坊和比特币都采用 <strong>secp256k1</strong> 曲线,这一公钥可被用于<strong>任意</strong>基于 secp256k1 的区块链上进行地址推导.</p><hr><h2 class=heading-element id=2-转换为比特币地址并在链上追查><span>2. 转换为比特币地址并在链上追查</span>
<a href=#2-%e8%bd%ac%e6%8d%a2%e4%b8%ba%e6%af%94%e7%89%b9%e5%b8%81%e5%9c%b0%e5%9d%80%e5%b9%b6%e5%9c%a8%e9%93%be%e4%b8%8a%e8%bf%bd%e6%9f%a5 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=21-比特币地址生成规则><span>2.1 比特币地址生成规则</span>
<a href=#21-%e6%af%94%e7%89%b9%e5%b8%81%e5%9c%b0%e5%9d%80%e7%94%9f%e6%88%90%e8%a7%84%e5%88%99 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>在比特币链上,最经典的地址生成方式是 <strong>P2PKH</strong>（Pay to Public Key Hash）,即我们常见的以 <code>1</code> 开头的比特币主网地址.生成流程概述如下：</p><ol><li><p><strong>准备公钥</strong><br>一般使用<strong>压缩公钥</strong>（33 字节,前缀 <code>0x02</code> 或 <code>0x03</code>）更常见,也可以使用非压缩公钥（65 字节）,只是地址会不同.</p><ul><li>若 <code>PubKey_ETH</code> 是非压缩格式,需要根据 <code>Y</code> 坐标的奇偶,转换出对应压缩格式.</li></ul></li><li><p><strong>双哈希</strong><br>先对公钥做 <code>SHA-256</code>,再对结果做 <code>RIPEMD-160</code> → 得到 20 字节的 <strong>PubKey Hash</strong>.</p></li><li><p><strong>版本前缀与校验和</strong><br>在主网下,P2PKH 前缀为 <code>0x00</code>；然后对 “前缀 + PubKey Hash” 再做两次 <code>SHA-256</code>,取前 4 字节作为校验和,拼接在后面.</p></li><li><p><strong>Base58Check 编码</strong><br>最终可得到典型的 <code>1xxxx...</code> 形式的比特币地址（记为 <code>Addr_BTC</code>）.</p></li></ol><p>示例（Python 伪代码）：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>pub_key</span> <span class=o>=</span> <span class=n>compress</span><span class=p>(</span><span class=n>pub_key_65</span><span class=p>)</span>         <span class=c1># 若需压缩</span>
</span></span><span class=line><span class=cl><span class=n>sha_1</span> <span class=o>=</span> <span class=n>SHA256</span><span class=p>(</span><span class=n>pub_key</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>ripe_1</span> <span class=o>=</span> <span class=n>RIPEMD160</span><span class=p>(</span><span class=n>sha_1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>payload</span> <span class=o>=</span> <span class=sa>b</span><span class=s1>&#39;</span><span class=se>\x00</span><span class=s1>&#39;</span> <span class=o>+</span> <span class=n>ripe_1</span>            <span class=c1># 0x00为比特币P2PKH前缀</span>
</span></span><span class=line><span class=cl><span class=n>checksum</span> <span class=o>=</span> <span class=n>SHA256</span><span class=p>(</span><span class=n>SHA256</span><span class=p>(</span><span class=n>payload</span><span class=p>))[:</span><span class=mi>4</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>address_bytes</span> <span class=o>=</span> <span class=n>payload</span> <span class=o>+</span> <span class=n>checksum</span>
</span></span><span class=line><span class=cl><span class=n>btc_address</span> <span class=o>=</span> <span class=n>Base58CheckEncode</span><span class=p>(</span><span class=n>address_bytes</span><span class=p>)</span>  <span class=c1># 形如 1xxxx...</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=22-在比特币链上验证实际交易><span>2.2 在比特币链上验证实际交易</span>
<a href=#22-%e5%9c%a8%e6%af%94%e7%89%b9%e5%b8%81%e9%93%be%e4%b8%8a%e9%aa%8c%e8%af%81%e5%ae%9e%e9%99%85%e4%ba%a4%e6%98%93 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>有了 <code>Addr_BTC</code> 后,我们需要在比特币区块浏览器（如 blockchain.com、btc.com 等）查询该地址是否<strong>真有</strong>链上交易,且由它<strong>主动</strong>发起过交易（即该地址作为输入的交易）.</p><ol><li><p><strong>查询交易记录</strong><br>如果 <code>Addr_BTC</code> 从未有任何交易或仅仅收到过 BTC 而没有消费（花费）,则说明尚无证据表明<strong>同一个私钥</strong>实际在比特币链上操作过.</p></li><li><p><strong>获取公钥以再次验证</strong><br>在比特币的 P2PKH 脚本中,当一个地址<strong>花费</strong>对应的 UTXO 时,输入脚本会包含<strong>签名</strong>和<strong>公钥</strong>.</p><ul><li>区块浏览器通常可在输入脚本详情里看到签名和公钥（或解析后的信息）.</li><li>若该公钥与 <code>PubKey_ETH</code>（或其压缩/非压缩等效形式）<strong>完全一致</strong>,则可确认这是同一个私钥在比特币上签名的凭证.</li></ul></li></ol><p>由此,我们实现了从以太坊到比特币的“<strong>公钥跨链验证</strong>”——只有当在比特币区块上也能观察到该公钥用于签名的交易,才说明目标私钥确实跨链使用了.</p><hr><h2 class=heading-element id=3-多链追查的意义><span>3. 多链追查的意义</span>
<a href=#3-%e5%a4%9a%e9%93%be%e8%bf%bd%e6%9f%a5%e7%9a%84%e6%84%8f%e4%b9%89 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>一旦确认同一个私钥同时在以太坊和比特币上都有交易签名,就可以在更广的范围内分析该私钥的资金流向和交易行为：</p><ul><li><p><strong>合规审计 / AML（反洗钱）</strong><br>监管机构或安全部门可以根据已知的以太坊地址,顺藤摸瓜查看是否在比特币网络也有活跃,进而更全面地掌握可疑资金的跨链转移路径.</p></li><li><p><strong>资产管理与风控</strong><br>一些多链钱包用户可能有意或无意地<strong>复用</strong>同一个私钥.安全审计时需注意这一点——一旦某条链上私钥泄露,其他链上地址也会面临风险.</p></li><li><p><strong>研究和数据分析</strong><br>对多链生态的学术研究、市场分析或用户画像时,也可借助此方法发现跨链关联,为高维度数据分析提供帮助.</p></li></ul><hr><h2 class=heading-element id=4-注意事项><span>4. 注意事项</span>
<a href=#4-%e6%b3%a8%e6%84%8f%e4%ba%8b%e9%a1%b9 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><ol><li><p><strong>仅能对“主动发起过”交易的地址恢复公钥</strong></p><ul><li>在以太坊上,如果一个地址仅接收代币或转账而从未发起过交易,则无法通过 <code>ecrecover</code> 获取它的公钥.</li><li>在比特币上,只有当某地址“花费”了它的 UTXO,才会在交易输入脚本里暴露公钥.</li></ul></li><li><p><strong>同一私钥 ≠ 同一助记词</strong></p><ul><li>助记词 (BIP39) 可以派生出许多子私钥.即使两个地址共用同一个私钥,也不一定是同一助记词；用户也可能手工导入相同私钥到不同钱包.</li></ul></li><li><p><strong>极小概率碰撞</strong></p><ul><li>理论上,不同助记词或随机生成方式可能极低概率地产生相同私钥,但概率极其微小（约 2^-256）,几乎可忽略不计.</li></ul></li><li><p><strong>隐私与匿名</strong></p><ul><li>一旦在一条链上签名,就有可能被恢复出公钥,从而推导到其他链可能的地址；这在某些情况下会降低用户的匿名性与隐私保护.</li></ul></li></ol><hr><h2 class=heading-element id=5-总结><span>5. 总结</span>
<a href=#5-%e6%80%bb%e7%bb%93 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p>“<strong>基于区块链交易公钥在多链进行跨链追查</strong>”的核心思路就是：</p><ol><li><strong>先在一条链（如以太坊）上,通过已发起交易恢复公钥</strong>.</li><li><strong>将该公钥按照其他采用 secp256k1 曲线的区块链（如比特币）的地址生成规则进行转换</strong>.</li><li><strong>在目标链上查询是否有实际签名交易</strong>,并可进一步对比公钥来确认.</li></ol><p>如果确有对应的签名交易,那就可以确定同一个私钥跨链使用,从而对资金流动和交易行为做更深层次的分析.这种方法在安全审计、合规检查、反洗钱以及多链资产研究等场景中都扮演着重要角色,为区块链行业的健康有序发展提供了技术支持.</p><blockquote><p><strong>简而言之</strong>,只要能在以太坊上获取到实际公钥,就可在比特币乃至更多基于 secp256k1 的链上推导相应地址并查验是否存在签名交易.若确认有实际交易且公钥匹配,即可判定由<strong>同一个私钥</strong>控制.这一跨链验证思路,对于打通区块链生态和深入挖掘跨链资金流向至关重要.</p></blockquote></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span title="更新于 2025-02-28 01:00:00">更新于 2025-02-28&nbsp;</span></div><div class=post-info-license><span><a rel="license external nofollow noopener noreferrer" href=https://creativecommons.org/licenses/by-nc-sa/4.0/ target=_blank>CC BY-NC-SA 4.0</a></span></div></div><div class=post-info-line><div class=post-info-md><span><a href=/posts/tracking-transactions-multiple-pubkey/index.md title=阅读原始文档 class=link-to-markdown>阅读原始文档</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="分享到 X" data-sharer=twitter data-url=https://www.lucas6.xyz/posts/tracking-transactions-multiple-pubkey/ data-title="基于区块链交易公钥在多链进行跨链追查: 原理与实践" data-hashtags=public-key,cross-chain,ecrecover,bitcoin,ethereum><i class="fa-brands fa-x-twitter fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 Facebook" data-sharer=facebook data-url=https://www.lucas6.xyz/posts/tracking-transactions-multiple-pubkey/ data-hashtag=public-key><i class="fa-brands fa-facebook-square fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 微博" data-sharer=weibo data-url=https://www.lucas6.xyz/posts/tracking-transactions-multiple-pubkey/ data-title="基于区块链交易公钥在多链进行跨链追查: 原理与实践"><i class="fa-brands fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fa-solid fa-tags fa-fw me-1" aria-hidden=true></i><a href=/tags/public-key/ class=post-tag title="标签 - Public-Key">Public-Key</a><a href=/tags/cross-chain/ class=post-tag title="标签 - Cross-Chain">Cross-Chain</a><a href=/tags/ecrecover/ class=post-tag title="标签 - Ecrecover">Ecrecover</a><a href=/tags/bitcoin/ class=post-tag title="标签 - Bitcoin">Bitcoin</a><a href=/tags/ethereum/ class=post-tag title="标签 - Ethereum">Ethereum</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/posts/gen-privkey/ class=post-nav-item rel=prev title="Generating Blockchain Private Key"><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i>Generating Blockchain Private Key</a><a href=/posts/sig-recovery-pubkey/ class=post-nav-item rel=next title=从签名中恢复账户公钥>从签名中恢复账户公钥<i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article><aside class=toc id=toc-auto aria-label=目录><h2 class=toc-title>目录&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden=true></i></h2><div class=toc-content id=toc-content-auto></div></aside></main><footer class=footer><div class=footer-container><div class="footer-line powered">由 <a href=https://gohugo.io/ target=_blank rel="external nofollow noopener noreferrer" title="Hugo 0.147.7"><img class=hugo-icon src=/images/hugo.min.svg alt="Hugo logo"> Hugo</a> 强力驱动 | 主题 - <a href=https://github.com/hugo-fixit/FixIt target=_blank rel=external title="FixIt v0.4.0-alpha-20250721024521-a1cd700b"><img class=fixit-icon src=/images/fixit.min.svg alt="FixIt logo"> FixIt</a></div><div class="footer-line copyright" itemscope itemtype=http://schema.org/CreativeWork><i class="fa-regular fa-copyright fa-fw" aria-hidden=true></i>
<span itemprop=copyrightYear>2023 - 2025</span><span class=author itemprop=copyrightHolder>
<a href=https://www.lucas6.xyz target=_blank rel="external nofollow noopener noreferrer">Lucas</a></span><span class="license footer-divider"><a href=https://www.lucas6.xyz/copyright/ target=_blank>版权声明 / Copyright</a> | <a rel="license external nofollow noopener noreferrer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div><div class="footer-line beian"><span class=gov><a target=_blank href="https://beian.mps.gov.cn/#/query/webSearch?code=41100002000596" style=display:inline-block;text-decoration:none;height:20px;line-height:20px><img src=/images/beian.png style=height:20px;float:left><span style=margin-left:5px>豫公网安备 41100002000596号</span></a></span><span class="icp footer-divider"><a href=https://beian.miit.gov.cn/ target=_blank rel="nofollow noopener noreferrer">豫ICP备2025141250号-1</a></span></div></div></footer></div><div class=widgets><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role=button aria-label=回到顶部><i class="fa-solid fa-arrow-up fa-fw" aria-hidden=true></i><span class="variant-numeric d-none">0%</span></div></div><div id=mask></div><noscript><div class=noscript-warning>该网站在启用 JavaScript 的情况下效果最佳。</div></noscript></div><link rel=stylesheet href=/lib/cookieconsent/cookieconsent.min.css><script src=/lib/sharer/sharer.min.js async defer></script><script src=/lib/cookieconsent/cookieconsent.min.js defer></script><script>window.config={code:{copyTitle:"复制到剪贴板",editLockTitle:"锁定可编辑代码块",editUnLockTitle:"解锁可编辑代码块",editable:!0,maxShownLines:10},comment:{enable:!1},cookieconsent:{content:{dismiss:"同意",link:"了解更多",message:"本网站使用 Cookies 来改善您的浏览体验。"},enable:!0,palette:{button:{background:"#f0f0f0"},popup:{background:"#1aa3ff"}},theme:"edgeless"},version:"v0.4.0-alpha-20250721024521-a1cd700b"}</script><script src=/js/theme.min.js defer></script></body></html>